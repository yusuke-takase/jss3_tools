<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Parallel simulation tutorial</title>
    <meta name="description" content="Parallel simulation tutorial">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Global stylesheet. We might switch to Bootstrap in the future -->
    <link rel="stylesheet" href="sakura.css">

    <!-- KaTeX files -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
      integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq"
      crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
      integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
      crossorigin="anonymous">
    </script>

    <!-- To automatically render math in text elements, include the
    auto-render extension: -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
      integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI"
      crossorigin="anonymous"
      onload="renderMathInElement(document.body);">
    </script>

  </head>

  <body>
    <div class="container">
      <h1 id="parallel-simulation-tutorial">Parallel simulation tutorial</h1>
<p>The simulation starts at t0=0 and lasts 86400.0 seconds.</p>
<p>The seed used for the random number generator is 12345.</p>
<div class="toc">
<ul>
<li><a href="#parallel-simulation-tutorial">Parallel simulation tutorial</a><ul>
<li><a href="#generation-of-spacecraft-quaternions">Generation of spacecraft quaternions</a></li>
<li><a href="#coverage-map">Coverage map</a></li>
<li><a href="#instrument-model-objects">Instrument model objects</a></li>
<li><a href="#source-code-used-in-the-simulation">Source code used in the simulation</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="generation-of-spacecraft-quaternions">Generation of spacecraft quaternions</h2>
<p>Quaternions have been created for the simulation:</p>
<ul>
<li>One quaternion every 60.0 seconds;</li>
<li>
<p>Memory usage: 46.1 kB</p>
<h2 id="coverage-map">Coverage map</h2>
<p>Here is the coverage map:</p>
<p><img alt="" src="coverage_map.png" /></p>
<p>The fraction of sky covered is 70628/196608 pixels
(35.9%).</p>
<p>The total number of hit is 172800.0</p>
</li>
</ul>
<h2 id="instrument-model-objects">Instrument model objects</h2>
<h2 id="source-code-used-in-the-simulation">Source code used in the simulation</h2>
<ul>
<li>Main repository: <a href="https://github.com/litebird/litebird_sim">github.com/litebird/litebird_sim</a></li>
<li>Version: 0.10.0, by The LiteBIRD simulation team</li>
<li>Commit hash: <a href="https://github.com/litebird/litebird_sim/commit/6d5a621b02a5762ad4e2b6a0025d75c3b94d725a">6d5a621</a>
    (commit comment: <em>fix bug</em>, by yusuke-takase)</li>
</ul>
<p>Since the last commit, the following changes have been made to the
code that has been ran:</p>
<pre><code>diff --git a/.ipynb_checkpoints/build_jupyter-checkpoint.py b/.ipynb_checkpoints/build_jupyter-checkpoint.py
index 7c5218b..06085c9 100644
--- a/.ipynb_checkpoints/build_jupyter-checkpoint.py
+++ b/.ipynb_checkpoints/build_jupyter-checkpoint.py
@@ -11,7 +11,7 @@ jss_account = &quot;t541&quot;
 vnode       = 1
 vnode_core  = 1
 vnode_mem   = 24          # unit: GiB
-elapse      = &quot;4:00:00&quot;   # hh:mm:ss
+elapse      = &quot;12:00:00&quot;   # hh:mm:ss
 jobname     = &quot;jupyter&quot;
 port        = 7123 

diff --git a/build_jupyter.py b/build_jupyter.py
index 7c5218b..06085c9 100644
--- a/build_jupyter.py
+++ b/build_jupyter.py
@@ -11,7 +11,7 @@ jss_account = &quot;t541&quot;
 vnode       = 1
 vnode_core  = 1
 vnode_mem   = 24          # unit: GiB
-elapse      = &quot;4:00:00&quot;   # hh:mm:ss
+elapse      = &quot;12:00:00&quot;   # hh:mm:ss
 jobname     = &quot;jupyter&quot;
 port        = 7123 

diff --git a/example/.d0026722526 b/example/.d0026722526
deleted file mode 100755
index c7f9259..0000000
--- a/example/.d0026722526
+++ /dev/null
@@ -1,18 +0,0 @@
-#!/bin/zsh
-#JX --bizcode DU10503
-#JX -L rscunit=RURI
-#JX -L vnode=1
-#JX -L vnode-core=1
-#JX -L vnode-mem=24Gi
-#JX -L elapse=4:00:00
-#JX -L jobenv=singularity
-#JX -o /data/t/t541/.log/jupyter/%n_%j.out
-#JX -e /data/t/t541/.log/jupyter/%n_%j.err
-#JX --spath /data/t/t541/.log/%n_%j.stats
-#JX -N jupyter
-#JX -S
-
-source /data/t/t541/.src/anaconda3/etc/profile.d/conda.sh
-conda activate jupy
-module load singularity
-singularity run /data/t/t541/.src/singularity/ubuntu_20.04_jupyter_edit.sif jupyter lab --ip=0.0.0.0 --no-browser
\ No newline at end of file
diff --git a/example/.d0026722526_nodeinfo b/example/.d0026722526_nodeinfo
deleted file mode 100755
index 17ac2a5..0000000
--- a/example/.d0026722526_nodeinfo
+++ /dev/null
@@ -1 +0,0 @@
-10.3.16.23
diff --git a/example/.d0026722526e b/example/.d0026722526e
deleted file mode 100755
index b783ee3..0000000
--- a/example/.d0026722526e
+++ /dev/null
@@ -1,8 +0,0 @@
-#!/bin/sh
-
-#
-# This is the wrapper script for executing epilogue
-#
-# DO NOT EDIT this file !!  edit the main script below
-#
-exec /opt/local/tcs/x86_64/epilogue/epilogue_main.sh
diff --git a/example/.d0026722526p b/example/.d0026722526p
deleted file mode 100755
index 3c051a0..0000000
--- a/example/.d0026722526p
+++ /dev/null
@@ -1,8 +0,0 @@
-#!/bin/sh
-
-#
-# This is the wrapper script for executing prologue
-#
-# DO NOT EDIT this file !!  edit the main script below
-#
-exec /opt/local/tcs/x86_64/prologue/prologue_main.sh
diff --git a/example/.ipynb_checkpoints/run_parallel-checkpoint.py b/example/.ipynb_checkpoints/run_parallel-checkpoint.py
index d16693f..fc48809 100644
--- a/example/.ipynb_checkpoints/run_parallel-checkpoint.py
+++ b/example/.ipynb_checkpoints/run_parallel-checkpoint.py
@@ -15,6 +15,7 @@ user_email  = &quot;takase_y@s.okayama-u.ac.jp&quot;
 coderoot    = f&quot;/home/{jss_account[0]}/{jss_account}/data/jss3_tools/example&quot;
 lbsim_code  = &quot;get_hitmap_parallel.py&quot;
 jobscript   = coderoot + &quot;/&quot; + &quot;run_&quot;+job_name+&quot;.pjm&quot;
+conda_base  = f&quot;/ssd/{jss_account[0]}/{jss_account}/.src/anaconda3/etc/profile.d/conda.sh&quot;

 elapse      = &quot;00:01:00&quot; # When you use the `debug` mode you should requesgt &lt;= 1800 == &quot;00:30:00&quot;
 if mode == &quot;debug&quot;:
@@ -30,17 +31,17 @@ script_contents = &quot;&quot;&quot;#!/bin/zsh
 #JX -L vnode-core={vnode_core}
 #JX -L vnode-mem={vnode_mem}Gi

-#JX -o /data/{jss_account[0]}/{jss_account}/.log/%n_%j.out
-#JX -e /data/{jss_account[0]}/{jss_account}/.log/%n_%j.err
-#JX --spath /data/{jss_account[0]}/{jss_account}/.log/%n_%j.stats
+#JX -o {coderoot}/log/%n_%j.out
+#JX -e {coderoot}/log/%n_%j.err
+#JX --spath {coderoot}/log/%n_%j.stats
 #JX -N {job_name}
 #JX -m e
 #JX --mail-list {user_email}
 #JX -S
 #export OMP_NUM_THREADS=1

-module load intel 
-source /data/{jss_account[0]}/{jss_account}/.src/anaconda3/etc/profile.d/conda.sh
+module load intel
+source {conda_base}
 conda activate lbs_env

 cd {coderoot}
diff --git a/example/get_hitmap_serial/report.html b/example/get_hitmap_serial/report.html
index 2857590..4ba8dde 100644
--- a/example/get_hitmap_serial/report.html
+++ b/example/get_hitmap_serial/report.html
@@ -71,20 +71,100 @@
 &lt;ul&gt;
 &lt;li&gt;Main repository: &lt;a href=&quot;https://github.com/litebird/litebird_sim&quot;&gt;github.com/litebird/litebird_sim&lt;/a&gt;&lt;/li&gt;
 &lt;li&gt;Version: 0.10.0, by The LiteBIRD simulation team&lt;/li&gt;
-&lt;li&gt;Commit hash: &lt;a href=&quot;https://github.com/litebird/litebird_sim/commit/6ed25e15676e06cef8b2a79aca0b03a9bb61e7ee&quot;&gt;6ed25e1&lt;/a&gt;
-    (commit comment: &lt;em&gt;add example, update README.md&lt;/em&gt;, by yusuke-takase)&lt;/li&gt;
+&lt;li&gt;Commit hash: &lt;a href=&quot;https://github.com/litebird/litebird_sim/commit/6d5a621b02a5762ad4e2b6a0025d75c3b94d725a&quot;&gt;6d5a621&lt;/a&gt;
+    (commit comment: &lt;em&gt;fix bug&lt;/em&gt;, by yusuke-takase)&lt;/li&gt;
 &lt;/ul&gt;
 &lt;p&gt;Since the last commit, the following changes have been made to the
 code that has been ran:&lt;/p&gt;
-&lt;pre&gt;&lt;code&gt;diff --git a/example/get_hitmap_serial/coverage_map.png b/example/get_hitmap_serial/coverage_map.png
-index 6ed9a13..260efcd 100644
-Binary files a/example/get_hitmap_serial/coverage_map.png and b/example/get_hitmap_serial/coverage_map.png differ
-diff --git a/example/get_hitmap_serial/hitmap.fits b/example/get_hitmap_serial/hitmap.fits
-index e0185b4..b613a1a 100644
-Binary files a/example/get_hitmap_serial/hitmap.fits and b/example/get_hitmap_serial/hitmap.fits differ
+&lt;pre&gt;&lt;code&gt;diff --git a/.ipynb_checkpoints/build_jupyter-checkpoint.py b/.ipynb_checkpoints/build_jupyter-checkpoint.py
+index 7c5218b..06085c9 100644
+--- a/.ipynb_checkpoints/build_jupyter-checkpoint.py
++++ b/.ipynb_checkpoints/build_jupyter-checkpoint.py
+@@ -11,7 +11,7 @@ jss_account = &amp;quot;t541&amp;quot;
+ vnode       = 1
+ vnode_core  = 1
+ vnode_mem   = 24          # unit: GiB
+-elapse      = &amp;quot;4:00:00&amp;quot;   # hh:mm:ss
++elapse      = &amp;quot;12:00:00&amp;quot;   # hh:mm:ss
+ jobname     = &amp;quot;jupyter&amp;quot;
+ port        = 7123 
+
+diff --git a/build_jupyter.py b/build_jupyter.py
+index 7c5218b..06085c9 100644
+--- a/build_jupyter.py
++++ b/build_jupyter.py
+@@ -11,7 +11,7 @@ jss_account = &amp;quot;t541&amp;quot;
+ vnode       = 1
+ vnode_core  = 1
+ vnode_mem   = 24          # unit: GiB
+-elapse      = &amp;quot;4:00:00&amp;quot;   # hh:mm:ss
++elapse      = &amp;quot;12:00:00&amp;quot;   # hh:mm:ss
+ jobname     = &amp;quot;jupyter&amp;quot;
+ port        = 7123 
+
+diff --git a/example/.d0026722526 b/example/.d0026722526
+deleted file mode 100755
+index c7f9259..0000000
+--- a/example/.d0026722526
++++ /dev/null
+@@ -1,18 +0,0 @@
+-#!/bin/zsh
+-#JX --bizcode DU10503
+-#JX -L rscunit=RURI
+-#JX -L vnode=1
+-#JX -L vnode-core=1
+-#JX -L vnode-mem=24Gi
+-#JX -L elapse=4:00:00
+-#JX -L jobenv=singularity
+-#JX -o /data/t/t541/.log/jupyter/%n_%j.out
+-#JX -e /data/t/t541/.log/jupyter/%n_%j.err
+-#JX --spath /data/t/t541/.log/%n_%j.stats
+-#JX -N jupyter
+-#JX -S
+-
+-source /data/t/t541/.src/anaconda3/etc/profile.d/conda.sh
+-conda activate jupy
+-module load singularity
+-singularity run /data/t/t541/.src/singularity/ubuntu_20.04_jupyter_edit.sif jupyter lab --ip=0.0.0.0 --no-browser
+\ No newline at end of file
+diff --git a/example/.d0026722526_nodeinfo b/example/.d0026722526_nodeinfo
+deleted file mode 100755
+index 17ac2a5..0000000
+--- a/example/.d0026722526_nodeinfo
++++ /dev/null
+@@ -1 +0,0 @@
+-10.3.16.23
+diff --git a/example/.d0026722526e b/example/.d0026722526e
+deleted file mode 100755
+index b783ee3..0000000
+--- a/example/.d0026722526e
++++ /dev/null
+@@ -1,8 +0,0 @@
+-#!/bin/sh
+-
+-#
+-# This is the wrapper script for executing epilogue
+-#
+-# DO NOT EDIT this file !!  edit the main script below
+-#
+-exec /opt/local/tcs/x86_64/epilogue/epilogue_main.sh
+diff --git a/example/.d0026722526p b/example/.d0026722526p
+deleted file mode 100755
+index 3c051a0..0000000
+--- a/example/.d0026722526p
++++ /dev/null
+@@ -1,8 +0,0 @@
+-#!/bin/sh
+-
+-#
+-# This is the wrapper script for executing prologue
+-#
+-# DO NOT EDIT this file !!  edit the main script below
+-#
+-exec /opt/local/tcs/x86_64/prologue/prologue_main.sh
 &lt;/code&gt;&lt;/pre&gt;
 &lt;hr /&gt;
-&lt;p&gt;Report written on 2023-08-31 20:58:33&lt;/p&gt;
+&lt;p&gt;Report written on 2023-09-01 13:47:37&lt;/p&gt;
     &lt;/div&gt;

 &lt;/body&gt;
diff --git a/example/get_hitmap_serial/report.md b/example/get_hitmap_serial/report.md
index 92deadd..e48217e 100644
--- a/example/get_hitmap_serial/report.md
+++ b/example/get_hitmap_serial/report.md
@@ -39,8 +39,8 @@ The total number of hit is 172800.0

 -   Main repository: [github.com/litebird/litebird_sim](https://github.com/litebird/litebird_sim)
 -   Version: 0.10.0, by The LiteBIRD simulation team
--   Commit hash: [6ed25e1](https://github.com/litebird/litebird_sim/commit/6ed25e15676e06cef8b2a79aca0b03a9bb61e7ee)
-    (commit comment: *add example, update README.md*, by yusuke-takase)
+-   Commit hash: [6d5a621](https://github.com/litebird/litebird_sim/commit/6d5a621b02a5762ad4e2b6a0025d75c3b94d725a)
+    (commit comment: *fix bug*, by yusuke-takase)



@@ -48,14 +48,94 @@ Since the last commit, the following changes have been made to the
 code that has been ran:

 ```
-diff --git a/example/get_hitmap_serial/coverage_map.png b/example/get_hitmap_serial/coverage_map.png
-index 6ed9a13..260efcd 100644
-Binary files a/example/get_hitmap_serial/coverage_map.png and b/example/get_hitmap_serial/coverage_map.png differ
-diff --git a/example/get_hitmap_serial/hitmap.fits b/example/get_hitmap_serial/hitmap.fits
-index e0185b4..b613a1a 100644
-Binary files a/example/get_hitmap_serial/hitmap.fits and b/example/get_hitmap_serial/hitmap.fits differ
+diff --git a/.ipynb_checkpoints/build_jupyter-checkpoint.py b/.ipynb_checkpoints/build_jupyter-checkpoint.py
+index 7c5218b..06085c9 100644
+--- a/.ipynb_checkpoints/build_jupyter-checkpoint.py
++++ b/.ipynb_checkpoints/build_jupyter-checkpoint.py
+@@ -11,7 +11,7 @@ jss_account = &quot;t541&quot;
+ vnode       = 1
+ vnode_core  = 1
+ vnode_mem   = 24          # unit: GiB
+-elapse      = &quot;4:00:00&quot;   # hh:mm:ss
++elapse      = &quot;12:00:00&quot;   # hh:mm:ss
+ jobname     = &quot;jupyter&quot;
+ port        = 7123 
+ 
+diff --git a/build_jupyter.py b/build_jupyter.py
+index 7c5218b..06085c9 100644
+--- a/build_jupyter.py
++++ b/build_jupyter.py
+@@ -11,7 +11,7 @@ jss_account = &quot;t541&quot;
+ vnode       = 1
+ vnode_core  = 1
+ vnode_mem   = 24          # unit: GiB
+-elapse      = &quot;4:00:00&quot;   # hh:mm:ss
++elapse      = &quot;12:00:00&quot;   # hh:mm:ss
+ jobname     = &quot;jupyter&quot;
+ port        = 7123 
+ 
+diff --git a/example/.d0026722526 b/example/.d0026722526
+deleted file mode 100755
+index c7f9259..0000000
+--- a/example/.d0026722526
++++ /dev/null
+@@ -1,18 +0,0 @@
+-#!/bin/zsh
+-#JX --bizcode DU10503
+-#JX -L rscunit=RURI
+-#JX -L vnode=1
+-#JX -L vnode-core=1
+-#JX -L vnode-mem=24Gi
+-#JX -L elapse=4:00:00
+-#JX -L jobenv=singularity
+-#JX -o /data/t/t541/.log/jupyter/%n_%j.out
+-#JX -e /data/t/t541/.log/jupyter/%n_%j.err
+-#JX --spath /data/t/t541/.log/%n_%j.stats
+-#JX -N jupyter
+-#JX -S
+-
+-source /data/t/t541/.src/anaconda3/etc/profile.d/conda.sh
+-conda activate jupy
+-module load singularity
+-singularity run /data/t/t541/.src/singularity/ubuntu_20.04_jupyter_edit.sif jupyter lab --ip=0.0.0.0 --no-browser
+\ No newline at end of file
+diff --git a/example/.d0026722526_nodeinfo b/example/.d0026722526_nodeinfo
+deleted file mode 100755
+index 17ac2a5..0000000
+--- a/example/.d0026722526_nodeinfo
++++ /dev/null
+@@ -1 +0,0 @@
+-10.3.16.23
+diff --git a/example/.d0026722526e b/example/.d0026722526e
+deleted file mode 100755
+index b783ee3..0000000
+--- a/example/.d0026722526e
++++ /dev/null
+@@ -1,8 +0,0 @@
+-#!/bin/sh
+-
+-#
+-# This is the wrapper script for executing epilogue
+-#
+-# DO NOT EDIT this file !!  edit the main script below
+-#
+-exec /opt/local/tcs/x86_64/epilogue/epilogue_main.sh
+diff --git a/example/.d0026722526p b/example/.d0026722526p
+deleted file mode 100755
+index 3c051a0..0000000
+--- a/example/.d0026722526p
++++ /dev/null
+@@ -1,8 +0,0 @@
+-#!/bin/sh
+-
+-#
+-# This is the wrapper script for executing prologue
+-#
+-# DO NOT EDIT this file !!  edit the main script below
+-#
+-exec /opt/local/tcs/x86_64/prologue/prologue_main.sh
 ```
 ---

-Report written on 2023-08-31 20:58:33
+Report written on 2023-09-01 13:47:37

diff --git a/example/run_parallel.py b/example/run_parallel.py
index d16693f..fc48809 100644
--- a/example/run_parallel.py
+++ b/example/run_parallel.py
@@ -15,6 +15,7 @@ user_email  = &quot;takase_y@s.okayama-u.ac.jp&quot;
 coderoot    = f&quot;/home/{jss_account[0]}/{jss_account}/data/jss3_tools/example&quot;
 lbsim_code  = &quot;get_hitmap_parallel.py&quot;
 jobscript   = coderoot + &quot;/&quot; + &quot;run_&quot;+job_name+&quot;.pjm&quot;
+conda_base  = f&quot;/ssd/{jss_account[0]}/{jss_account}/.src/anaconda3/etc/profile.d/conda.sh&quot;

 elapse      = &quot;00:01:00&quot; # When you use the `debug` mode you should requesgt &lt;= 1800 == &quot;00:30:00&quot;
 if mode == &quot;debug&quot;:
@@ -30,17 +31,17 @@ script_contents = &quot;&quot;&quot;#!/bin/zsh
 #JX -L vnode-core={vnode_core}
 #JX -L vnode-mem={vnode_mem}Gi

-#JX -o /data/{jss_account[0]}/{jss_account}/.log/%n_%j.out
-#JX -e /data/{jss_account[0]}/{jss_account}/.log/%n_%j.err
-#JX --spath /data/{jss_account[0]}/{jss_account}/.log/%n_%j.stats
+#JX -o {coderoot}/log/%n_%j.out
+#JX -e {coderoot}/log/%n_%j.err
+#JX --spath {coderoot}/log/%n_%j.stats
 #JX -N {job_name}
 #JX -m e
 #JX --mail-list {user_email}
 #JX -S
 #export OMP_NUM_THREADS=1

-module load intel 
-source /data/{jss_account[0]}/{jss_account}/.src/anaconda3/etc/profile.d/conda.sh
+module load intel
+source {conda_base}
 conda activate lbs_env

 cd {coderoot}
</code></pre>
<hr />
<p>Report written on 2023-09-01 13:56:58</p>
    </div>

</body>
</html>